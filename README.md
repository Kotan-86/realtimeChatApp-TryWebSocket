# リアルタイムチャットアプリで学ぶWebSocket
Webのリアルタイム通信技術である`WebSocket`と従来からある HTTP通信(ポーリング)の違いを体験するために作られた、2種類のシンプルなチャットアプリケーションです。
1. WebSocket版チャット
2. HTTP通信版チャット

## 前提条件
このプロジェクトをあなたのPCで動かすには、以下のツールが必要です。もしインストールしていない場合は、リンク先を参考に準備してください。
* [Node.js](https://nodejs.org/ja) (バージョン 18 以上を推奨)
  * JavaScriptをサーバーサイドで動かすための環境です。npm という便利なパッケージ管理ツールも一緒にインストールされます。
* [Git](https://git-scm.com/)
  * ソースコードのバージョンを管理するためのツールです。今回はプロジェクトのダウンロードに使います。
* お好みのコードエディタ
  * Visual Studio Code などがおすすめです。

## セットアップ手順
さっそく、チャットアプリを動かす準備をしましょう！ ターミナル（WindowsならコマンドプロンプトやPowerShell、Macならターミナル）を開いて、以下のコマンドを1つずつ実行してください。

### プロジェクトのダウンロード(Clone)
まず、git clone コマンドを使って、このプロジェクトのソースコード一式をあなたのPCにコピーします。
```bash
git clone https://github.com/Kotan-86/realtimeChatApp-TryWebSocket.git
```
### プロジェクトフォルダの移動
ダウンロードしたフォルダに移動します。今後の作業はすべてこのフォルダ内で行います。
```bash
cd realtimeChatApp-TryWebSocket
```

## アプリケーションの実行方法
いよいよチャットアプリを起動します。WebSocket版とHTTP版、それぞれ起動コマンドとアクセスするURLが異なりますのでご注意ください。
### WebSocket版チャットの実行
真のリアルタイム通信を体験してみましょう！
1. サーバーを起動する
```bash
npx ts-node src/server.ts
```
ターミナルに「チャットサーバーが http://localhost:3000 で起動しました」と表示されれば成功です。
2. ブラウザでアクセスする
`http://localhost:3000`と入力してアクセスしてください。
3. 動作を確認する
チャット画面が表示されたら、ブラウザのタブをもう一つ開いて、同じ`http://localhost:3000`にアクセスしてみてください。 
片方のタブでメッセージを送信すると、もう片方のタブにも瞬時にメッセージが表示されるのが確認できます。
### HTTPポーリング版チャットの実行
次に、擬似的なリアルタイム通信を体験します。
1. サーバーを起動する
```Bash
npx ts-node src/server-http.ts
```
ターミナルに「HTTPチャットサーバーが http://localhost:3000/index-http.html で起動しました」と表示されれば成功です。
2. ブラウザでアクセスする
`http://localhost:3000/index-http.html`と入力してアクセスしてください

3. 違いを観察する
こちらも複数のタブでチャットができますが、ぜひ ブラウザの開発者ツール（F12キーや Ctrl+Shift+I で開けます）の「Network」タブを開きながら操作してみてください。

## ファイル構成
このプロジェクトの主要なファイルと、その役割は以下の通りです。
```
simple-chat/
├── package.json         # プロジェクトの設計図。必要なライブラリが書かれている。
├── src/
│   ├── server.ts        # WebSocket版チャットのバックエンド(サーバー)
│   └── server-http.ts   # HTTPポーリング版チャットのバックエンド(サーバー)
└── public/
    ├── index.html       # WebSocket版チャットのフロントエンド(見た目)
    ├── client.js        # WebSocket版チャットのフロントエンド(動作)
    ├── index-http.html  # HTTP版チャットのフロントエンド(見た目)
    └── client-http.js   # HTTP版チャットのフロントエンド(動作)
```
ぜひ、それぞれのファイルを開いて、コードがどのように違うのかを見比べてみてください！# realtimeChatApp-TryWebSocket
